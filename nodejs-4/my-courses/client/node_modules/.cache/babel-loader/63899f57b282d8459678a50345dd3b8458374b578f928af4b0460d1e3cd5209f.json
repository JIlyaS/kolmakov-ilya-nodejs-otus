{"ast":null,"code":"import { createEffect, createEvent, createStore, sample } from \"effector\";\nimport { persist } from 'effector-storage/local';\nimport { getUsers as getUsersApi, getUser as getUserApi } from \"../../api/rest/users\";\nimport { loginUserFx } from \"../auth/model\";\nconst $userId = createStore(null);\nconst getUsers = createEvent();\nconst getUser = createEvent();\nconst getUsersFx = createEffect(() => getUsersApi());\nconst getUserFx = createEffect(id => getUserApi(id));\nsample({\n  clock: loginUserFx.doneData,\n  fn: data => data.data.userId,\n  target: $userId\n});\npersist({\n  store: $userId,\n  key: 'userId'\n});\nsample({\n  clock: getUsers,\n  target: getUsersFx\n});\nsample({\n  clock: getUser,\n  target: getUserFx\n});\nsample({\n  clock: getUserFx.doneData,\n  fn: data => {\n    localStorage.setItem(\"roles\", JSON.stringify(data.data.roles));\n  }\n});\nexport { getUser, $userId };","map":{"version":3,"names":["createEffect","createEvent","createStore","sample","persist","getUsers","getUsersApi","getUser","getUserApi","loginUserFx","$userId","getUsersFx","getUserFx","id","clock","doneData","fn","data","userId","target","store","key","localStorage","setItem","JSON","stringify","roles"],"sources":["/Users/ilakolmakov/kolmakov-ilya-nodejs-otus/nodejs-4/my-courses/client/src/entities/user/model.ts"],"sourcesContent":["import {\n    createEffect,\n    createEvent,\n    createStore,\n    sample,\n  } from \"effector\";\n  import { persist } from 'effector-storage/local';\n\n  import { getUsers as getUsersApi, getUser as getUserApi } from \"../../api/rest/users\";\n  import { User } from \"../../api/rest/users/types\";\n  import { loginUserFx } from \"../auth/model\";\n\n  const $userId = createStore<string | null>(null);\n  \n  const getUsers = createEvent();\n  const getUser = createEvent<string>();\n  \n  const getUsersFx = createEffect(() => getUsersApi());\n  const getUserFx = createEffect((id: string) => getUserApi(id));\n  \n  sample({\n    clock: loginUserFx.doneData,\n    fn: (data) => data.data.userId, \n    target: $userId\n  });\n\n  persist({ store: $userId, key: 'userId' })\n  \n  \n  sample({\n    clock: getUsers,\n    target: getUsersFx,\n  });\n  \n  sample({\n    clock: getUser,\n    target: getUserFx,\n  });\n\n  sample({\n    clock: getUserFx.doneData,\n    fn: (data) => {\n        localStorage.setItem(\"roles\", JSON.stringify(data.data.roles));\n    }\n  });\n  \n  export { getUser, $userId };\n  "],"mappings":"AAAA,SACIA,YAAY,EACZC,WAAW,EACXC,WAAW,EACXC,MAAM,QACD,UAAU;AACjB,SAASC,OAAO,QAAQ,wBAAwB;AAEhD,SAASC,QAAQ,IAAIC,WAAW,EAAEC,OAAO,IAAIC,UAAU,QAAQ,sBAAsB;AAErF,SAASC,WAAW,QAAQ,eAAe;AAE3C,MAAMC,OAAO,GAAGR,WAAW,CAAgB,IAAI,CAAC;AAEhD,MAAMG,QAAQ,GAAGJ,WAAW,EAAE;AAC9B,MAAMM,OAAO,GAAGN,WAAW,EAAU;AAErC,MAAMU,UAAU,GAAGX,YAAY,CAAC,MAAMM,WAAW,EAAE,CAAC;AACpD,MAAMM,SAAS,GAAGZ,YAAY,CAAEa,EAAU,IAAKL,UAAU,CAACK,EAAE,CAAC,CAAC;AAE9DV,MAAM,CAAC;EACLW,KAAK,EAAEL,WAAW,CAACM,QAAQ;EAC3BC,EAAE,EAAGC,IAAI,IAAKA,IAAI,CAACA,IAAI,CAACC,MAAM;EAC9BC,MAAM,EAAET;AACV,CAAC,CAAC;AAEFN,OAAO,CAAC;EAAEgB,KAAK,EAAEV,OAAO;EAAEW,GAAG,EAAE;AAAS,CAAC,CAAC;AAG1ClB,MAAM,CAAC;EACLW,KAAK,EAAET,QAAQ;EACfc,MAAM,EAAER;AACV,CAAC,CAAC;AAEFR,MAAM,CAAC;EACLW,KAAK,EAAEP,OAAO;EACdY,MAAM,EAAEP;AACV,CAAC,CAAC;AAEFT,MAAM,CAAC;EACLW,KAAK,EAAEF,SAAS,CAACG,QAAQ;EACzBC,EAAE,EAAGC,IAAI,IAAK;IACVK,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEC,IAAI,CAACC,SAAS,CAACR,IAAI,CAACA,IAAI,CAACS,KAAK,CAAC,CAAC;EAClE;AACF,CAAC,CAAC;AAEF,SAASnB,OAAO,EAAEG,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}